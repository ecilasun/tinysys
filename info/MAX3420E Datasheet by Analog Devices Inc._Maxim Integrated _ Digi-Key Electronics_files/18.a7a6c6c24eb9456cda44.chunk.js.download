try{(window["WAFQualtricsWebpackJsonP-cloud-1.84.1"]=window["WAFQualtricsWebpackJsonP-cloud-1.84.1"]||[]).push([[18],{58:function(e,t,n){"use strict";n.r(t);var o=n(3),r=n(4),i=n(24),a=function(e){var t=e.translations,n=e.translationSettings,a=e.question,s=e.recordResponseAndProceed,u=e.isFollowUp,c=e.preloadRendererForQID,d=Object(r.useState)(null),l=d[0],f=d[1],b=Object(r.useState)(null),p=b[0],v=b[1],O=Object(r.useState)(null),g=O[0],w=O[1],S=g;return null!==g&&l===a.QID&&p!==a.Style&&(w(null),S=null),Object(r.useEffect)(function(){var e=a.Format,t=a.Style;Object(i.a)(e,t).then(function(e){w(function(){return e}),f(a.QID),v(a.Style)})},[a]),null!==S&&l===a.QID?Object(o.h)(S,{translations:t,translationSettings:n,question:a,recordResponseAndProceed:s,isFollowUp:u,preloadRendererForQID:c}):Object(o.h)("div",null)},s=n(15),u=n(23);function c(e){window.QSI.dbg.e(e)}var d=n(6),l=n(5),f=Object(r.createContext)(null);var b=n(34);function p(e){var t,n,o;switch(e.questionConfiguration.Format){case"embedded-feedback-question-format-open-text":return(t={})[e.questionConfiguration.SurveyQuestionId]=e.recordedResponse,t;case"embedded-feedback-question-format-points":case"embedded-feedback-question-format-yes-no":default:return(n={})[e.questionConfiguration.SurveyQuestionId]=((o={})[e.recordedResponse]={selected:!0},o),n}}var v=function(e){var t,n,v=e.interceptOptions,O=v.id,g=v.surveyId,w=v.targetURLOrigin,S=Object(l.b)(f),j=S.Questions,m=Object(r.useState)(0),y=m[0],Q=m[1],I=Object(r.useState)(!1),C=I[0],h=I[1],R=Object(r.useState)(!1),q=R[0],k=R[1],P=Object(r.useState)(!1),D=P[0],E=P[1],F=w+"/DX/PostResponse/?SurveyId="+g+"&InterceptId="+O,T=window.QSI.global.featureFlags["DX.EmbeddedFeedback_NewAPIs"],x=(t=j,n=Object(r.useRef)(),Object(r.useEffect)(function(){n.current=t}),n.current);if(v.isPreview&&x)if(x.length!==j.length)Q(0);else if(x[0].Style!==j[0].Style)Q(0);else for(var A=0;A<j.length;A++)if(j[A].QuestionText!==x[A].QuestionText){Q(A);break}var L=Object(d.b)().legacyCreativeVal,_=Object(b.a)(g,O,L.requestId,S.SurveyVersionId),U=_.enqueueResponse,J=_.closeSurvey,M=Object(r.useMemo)(function(){return j.map(function(e){return{questionConfiguration:e,recordedResponse:null}})},[j]),N=M[y],W=s.a.getTranslation(S),X=s.a.getTranslationCode(S),B=function(e){c("Q_PostResponse returned error status:  "+e.status+" details: "+e.statusText)},H=Object(r.useCallback)(function(){if(T)J();else{if(D)return;e="POST",t=F,n=z(),o=B,(r=new XMLHttpRequest).open(e,t,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){try{4===r.readyState&&(200!==r.status?o(r):window.QSI.config.surveyResponseId=r.responseText)}catch(e){c(e)}},r.send(n),E(!0)}var e,t,n,o,r},[M,D,T,J]),V=Object(r.useCallback)(function(){var e={};return M.forEach(function(t){t.recordedResponse&&(e[t.questionConfiguration.SurveyQuestionId]=t.recordedResponse)}),JSON.stringify(e)},[M]),z=Object(r.useCallback)(function(){var e=u.a.getEmbeddedData(O);return null!==X&&(e.Q_Language=X),"Q_PostResponse="+encodeURIComponent(V())+"&ED="+encodeURIComponent(JSON.stringify(e))},[]),G=function(){Z("",!0)},K=Object(r.useCallback)(function(){if(!D&&!T)if(navigator&&navigator.sendBeacon){var e=new FormData;e.append("Q_PostResponse",V());var t=u.a.getEmbeddedData(O);null!==X&&(t.Q_Language=X),e.append("ED",JSON.stringify(t)),navigator.sendBeacon(F,e)}else H()},[D]);Object(r.useEffect)(function(){if(q&&"embedded-feedback-question-format-display-text"!=N.questionConfiguration.Format){var e=6e5;window.QSI&&window.QSI.config&&window.QSI.config.followupQuestionTimeoutMS&&(e=window.QSI.config.followupQuestionTimeoutMS);var t=window.setTimeout(G,e);return window.addEventListener("beforeunload",K),function(){window.removeEventListener("beforeunload",K),window.clearTimeout(t)}}},[q,D,N]);var Y=function(e){if(!e)return y+1;for(var t=0;t<M.length;t++)if(M[t].questionConfiguration.QID===e)return t;return y+1},Z=Object(r.useCallback)(function(e,t,n){if(N.recordedResponse=e,q||v.isPreview||L.clickWithImpression(),!v.isPreview){if(T){var o=u.a.getEmbeddedData(O);null!==X&&(o.Q_Language=X),U({embeddedData:o,recordedResponse:p(N)})}t&&H()}if("End"!==n){var r=Y(n);r>=M.length?h(!0):(k(!0),Q(r))}else h(!0)},[M,N,y,D,L]);return C||!N?null:Object(o.h)(a,{translations:W,translationSettings:S.TranslationSettings,question:N.questionConfiguration,recordResponseAndProceed:Z,isFollowUp:q,preloadRendererForQID:function(e){if("End"!==e){var t=Y(e);if(!(t>=M.length)){var n=M[t].questionConfiguration,o=n.Format,r=n.Style;Object(i.a)(o,r)}}}})},O=n(33),g=n(32),w=n(31),S=n(7),j=function(e){var t=e.creativeOptions,n=e.interceptOptions,r=t.Insertion,i=r.Selector,a=r.MaxNumberOfInsertions,s=Object(w.a)(t),u=s.Questions[0].Appearance.CustomCSS,c=Object(g.a)(u),d=Object(O.a)(v,n,i,c,a);return Object(o.h)(S.a.Provider,{value:n},Object(o.h)(f.Provider,{value:s},d))},m=n(30);n.d(t,"renderEmbeddedFeedback",function(){return Q});var y=function(){return(y=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function Q(e,t,n){var r={interceptOptions:t,creativeOptions:e},i=document.createElement("div");return i.style.display="none",Object(o.k)(Object(o.h)(m.a,{legacyCreative:n},Object(o.h)(j,y({},r))),document.body.appendChild(i)),{remove:function(){Object(o.k)(null,i),document.body.removeChild(i)}}}},7:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var o=n(5),r=n(4),i=Object(r.createContext)(null),a=function(){return Object(o.b)(i)}}}]);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}